ABAPZombie Guide to ABAP ‚Äì Parte 5 ‚Äì APPEND
Autor: Mauricio Cruz
Data: 08/02/2011 09:52

O APPEND, este velho conhecido dos programadores. Todos os programadores ABAP j√° deram APPEND em alguma tabela alguma vez na vida.
Se voc√™ ainda n√£o √© programador, eu explico: O APPEND adiciona uma nova linha no final da sua tabela interna.
‚Äì Para tabelas do tipo
STANDARD
, ele simplesmente adiciona a nova linha no final da tabela.
‚Äì Para tabelas do tipo
SORTED
ele vai apendar contato que a nova linha siga a sequ√™ncia da ordena√ß√£o da tabela interna, e se a nova linha n√£o criar uma linha duplicada.
‚Äì Para tabelas do tipo
HASHED
, desencane porque n√£o d√° para appendar.
Vamos ver o c√≥digo do APPEND e algumas terminologias:
REPORT  zombie_append.

* Tabela principal e tabela para c√≥pia.
DATA: t_mara  TYPE TABLE OF mara,
      t_mara2 TYPE TABLE OF mara INITIAL SIZE 10.
*      t_mara2 TYPE TABLE OF mara INITIAL SIZE 2.

* Work area gen√©rica
DATA: wa_mara LIKE LINE OF t_mara.

* APPEND simples
wa_mara-matnr = '1'.
APPEND wa_mara TO t_mara.

* APPEND linha vazia
APPEND INITIAL LINE TO t_mara.

BREAK-POINT.

* APPEND seguido de SORT
wa_mara-matnr = '3'.
APPEND wa_mara TO t_mara2 SORTED BY matnr.

wa_mara-matnr = '1'.
APPEND wa_mara TO t_mara2 SORTED BY matnr.

wa_mara-matnr = '2'.
APPEND wa_mara TO t_mara2 SORTED BY matnr.

BREAK-POINT.

* APPEND de dados de uma tabela em outra tabela
APPEND LINES OF t_mara TO t_mara2.

BREAK-POINT.
‚Äì O
APPEND INITIAL LINE
appenda uma linha vazia na tabela interna;
‚Äì O
APPEND LINES OF tab1 TO tab2
adiciona linhas de uma tabela em outra tabela.;
‚Äì O
APPEND wa1 TO tab1 SORTED BY
faz o APPEND e na sequ√™ncia j√° ordena a tabela do maior para o menor valor. Vale dizer que esse comando fica preso no tamanho m√°ximo da √°rea de mem√≥ria da tabela (‚ÄúINITIAL SIZE‚Äù), e se voc√™ ultrapassar o tamanho, o APPEND com SORTED BY apaga registros sem d√≥ nem piedade. Comente a linha com INITIAL SIZE 10, e descomente a linha com INITIAL SIZE 2 para ver isso acontecendo.
Esse √© um dos comandos essenciais no dia-a-dia de programadores. Mas ele ainda perde o IF em quantidade de utiliza√ß√µes üòõ
Abra√ßos!



Coment√°rios:
Custodio (20/07/2011 17:27): corrigindo meu comentario, ao usar INSERT vc continua tendo que se preocupar com duplicate key (se a tabela for WITH UNIQUE KEY), vc nao precisa se preocupar eh se a nova linha esta na sequencia do sort ou nao.
  Mauricio Cruz (20/07/2011 17:29): Quando eu chegar no INSERT vou explicar tudo isso, neste artigo √© s√≥ o APPEND mesmo üòâ
  Mauricio Cruz (20/07/2011 17:29): Quando eu chegar no INSERT vou explicar tudo isso, neste artigo √© s√≥ o APPEND mesmo üòâ
Custodio (19/07/2011 19:24): Ola pessoas, Parabens pelo blog, realmente nao ha muitas opcoes em Portugues, principalmente pra quem esta comecando. Tenho algumas observacoes aqui, e se o tempo deixar, farei sempre minha "revisao". ‚Äì Para tabelas do tipo SORTED ele vai apendar contato que a nova linha siga a sequ√™ncia da ordena√ß√£o da tabela interna, e se a nova linha n√£o criar uma linha duplicada. Na verdade, podera criar uma linha duplicada, se a tabela assim permitir (sorted table with non-unique key). De qualquer modo, se voce esta trabalhando com sorted table, esqueca o append e use insert, assim nao precisa se preocupar com duplicate keys. O APPEND wa1 TO tab1 SORTED BY faz o APPEND e na sequ√™ncia j√° ordena a tabela do maior para o menor valor. Vale dizer que esse comando fica preso no tamanho m√°ximo da √°rea de mem√≥ria da tabela (‚ÄúINITIAL SIZE‚Äù), e se voc√™ ultrapassar o tamanho, o APPEND com SORTED BY apaga registros sem d√≥ nem piedade. Correto, lembrando que o SORTED BY funciona apenas para standard tables.
  Mauricio Cruz (20/07/2011 05:48): Custodio, obrigado pelas observa√ß√µes! Sempre que voc√™ tiver ressalvas, pode postar, √© exatamente pra isso que servem os coment√°rios! Longe de mim ser o dono da verdade, o que eu quero √© aprender tamb√©m! hehe Um abra√ßo!
  Mauricio Cruz (20/07/2011 05:48): Custodio, obrigado pelas observa√ß√µes! Sempre que voc√™ tiver ressalvas, pode postar, √© exatamente pra isso que servem os coment√°rios! Longe de mim ser o dono da verdade, o que eu quero √© aprender tamb√©m! hehe Um abra√ßo!