ABAPZombie Guide to ABAP ‚Äì Parte 13 ‚Äì AT SELECTION-SCREEN
Autor: Mauricio Cruz
Data: 22/02/2011 08:40

O AT SELECTION-SCREEN √© um evento que permite manipular a√ß√µes do usu√°rio e do sistema durante o processo de exibi√ß√£o/altera√ß√£o da tela de sele√ß√£o de reports.
Ele tamb√©m √© conhecido com o
‚Äúevento divertido que nos ajuda a fazer as loucuras que usu√°rios/funcionais nos pedem‚Äù
. üôÇ
Antes de mais nada, eu utilizei diversas t√©cnicas do AT SELECTION SCREEN no post:
ABAP Zombie Screen Examples
. Vale a pena dar uma olhada üôÇ
Vamos l√°‚Ä¶
Basicamente, voc√™ pode criar eventos para manipular a tela em diversos momentos. Quando o SAP estiver processando a tela, ele poder√° passar pelos seguintes eventos:
AT SELECTION-SCREEN OUTPUT:
Evento no PBO (process before output) da tela de sele√ß√£o (antes dos valores serem exibidos).
AT SELECTION-SCREEN ON parameter/sel-option:
Evento do PAI (process after input) para um PARAMETER ou SELECT-OPTIONS. Ideal para validar o input dos usu√°rios em campos espec√≠ficos. Lembrando que radiobuttons devem ser tratados no evento apropriado.
AT SELECTION-SCREEN ON RADIOBUTTON GROUP nomedogrupo:
Mesmo coisa que o de cima, mas para Radiobuttons
AT SELECTION-SCREEN ON END OF sel-option:
Ir√° passar aqui no final do preenchimento do sel-options em quest√£o.
AT SELECTION-SCREEN ON BLOCK nomedobloco:
No PAI tamb√©m, no final do processamento do bloco XXX (aqueles que voc√™ define na declara√ß√£o da tela!).
AT SELECTION-SCREEN (sim, nada mais):
Esse √© o mais chato. Sempre vai ser disparado, e sempre por √∫ltimo hahaha.
AT SELECTION-SCREEN ON HELP-REQUEST FOR parameter/sel-option:
Quando alguem apertar F1 no campo especificado ap√≥s o FOR.
AT SELECTION-SCREEN ON VALUE-REQUEST FOR parameter/sel-option:
quando alguem aertar F4 no campo especificado ap√≥s o FOR
AT SELECTION-SCREEN ON EXIT-COMMAND:
Sempre que o usu√°rio quiser sair da tela, atrav√©s do EXIT, BACK ou o CANCEL, vai passar por aqui üôÇ
Bom, chega de teoria (eu sei, eu sei.. √© chato mas precisa, po! üòõ ).
Eu criei um programinha
firmeza
, bem did√°tico para voc√™ ver os diferentes momentos em que o programa dispara cada um destes eventos. Divirta-se testando:
REPORT zombie_at_selection_screen.

TABLES: mara.

* Tela de Sele√ß√£o beeeem simples!
SELECTION-SCREEN BEGIN OF BLOCK bloco1.

* Um simples enter ir√° passar pelos eventos:
* AT SELECTION-SCREEN ON p_any.
* AT SELECTION-SCREEN ON RADIOBUTTON GROUP rb1.
* AT SELECTION-SCREEN ON BLOCK bloco1.
* AT SELECTION-SCREEN.
PARAMETER: p_any  TYPE mara-matnr.

* Apertando F1 nesse campo, ir√° parar no evento:
* AT SELECTION-SCREEN ON HELP-REQUEST FOR p_f1.
PARAMETER: p_f1   TYPE mara-matnr.

* Apertando F4 nesse campo, ir√° parar no evento:
* AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_f4.
PARAMETER: p_f4   TYPE mara-matnr.

* Se voc√™ preencher v√°rias linhas aqui, ele ir√° parar no evento:
* AT SELECTION-SCREEN ON END OF s_any.
SELECT-OPTIONS: s_any FOR mara-matnr.

PARAMETER: p_sim RADIOBUTTON GROUP rb1,
           p_nao RADIOBUTTON GROUP rb1.

* Se voc√™ sair do Report, ir√° passar no evento
* AT SELECTION-SCREEN ON EXIT-COMMAND.

SELECTION-SCREEN END OF BLOCK bloco1.

* Como √© no PBO, vai passar aqui antes de exibir a tela.
AT SELECTION-SCREEN OUTPUT.
  BREAK-POINT.

AT SELECTION-SCREEN ON p_any.
  BREAK-POINT.

AT SELECTION-SCREEN ON RADIOBUTTON GROUP rb1.
  BREAK-POINT.

AT SELECTION-SCREEN ON END OF s_any.
  BREAK-POINT.

AT SELECTION-SCREEN ON BLOCK bloco1.
  BREAK-POINT.

AT SELECTION-SCREEN ON HELP-REQUEST FOR p_f1.
  BREAK-POINT.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_f4.
  BREAK-POINT.

* Se voc√™ tentar sair, vai parar aqui :)
AT SELECTION-SCREEN ON EXIT-COMMAND.
  BREAK-POINT.

AT SELECTION-SCREEN.
  BREAK-POINT.
√â s√≥ fazer o que os coment√°rios mandam para ver funcionando. üòÄ
Abra√ßos!



Coment√°rios:
Hilda (02/06/2016 10:07): Como posso usar o AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_f4 pegando o valor do parametro para um select.
Joao Mendes (03/12/2013 09:43): A p√°gina http://www.abapzombie.com/?p=168 nao existe mais.
  Mauricio Cruz (03/12/2013 09:46): Ajustado! üôÇ
    Acho que n√£o (30/12/2013 07:29): acho que n√£o.
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
    Acho que n√£o (30/12/2013 07:29): acho que n√£o.
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
  Mauricio Cruz (03/12/2013 09:46): Ajustado! üôÇ
    Acho que n√£o (30/12/2013 07:29): acho que n√£o.
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
    Acho que n√£o (30/12/2013 07:29): acho que n√£o.
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
      Mauricio Cruz (30/12/2013 07:31): Ok, melhorando a explica√ß√£o: Arrumei o link no post. Essa p√°gina que o cara postou no coment√°rio n√£o existe mesmo. Abs!
Rafael Chagas (15/11/2013 08:15): Muito bom post. Parab√©ns.