ABAPZombie Guide to ABAP ‚Äì Parte 31 ‚Äì GET TIME STAMP
Autor: Mauricio Cruz
Data: 08/03/2012 10:00

Pois √©, o ABAP tem um comando nativo para criar um timestamp, o
GET TIME STAMP
.
A minha falta de √¢nimo na frase acima tem um s√≥ motivo: esse √© um comando que poderia ser bem mais flex√≠vel, sem termos que ficar fazendo convers√µes para utilizar o valor retornado. Ali√°s, acredito que essa falta de flexibilidade √© o que faz com que a galera continue montando TIMESTAMPs ‚Äúna m√£o‚Äù, ou por fun√ß√µes/classes.
Anyway, vamos aos exemplos:
O GET TIME STAMP √© um comando bem direto: ele retorna um timestamp curto ou longo, da data e hora do sistema. O que define o ‚Äútamanho‚Äù do timestamp, √© o tipo da vari√°vel que voc√™ usar para capturar o timestamp. Veja abaixo:
REPORT zombie_timestamp.

DATA: l_curto TYPE timestamp,
      l_longo TYPE timestampl.


* "Estampa" o Tempo! (p√©√©√©√©√©ssima piada)
GET TIME STAMP FIELD l_curto.
GET TIME STAMP FIELD l_longo.
Mas tem um por√©m: o timestamp vai te retornar o hor√°rio de acordo com o UTC (
Tempo Universal Coordenado
). Ou seja, para usar o timestamp no hor√°rio daqui do Brazil, voc√™ tem que fazer uma convers√£o levando em conta o timezone do lugar em que voc√™ se encontra. A convers√£o pode ser feita por diversos comandos, mas segue um exemplo com o comando WRITE:
REPORT zombie_timestamp.

DATA: l_curto TYPE timestamp,
      l_longo TYPE timestampl.

GET TIME STAMP FIELD l_curto.
GET TIME STAMP FIELD l_longo.

* Convers√£o de acordo com o TimeZone.
* Para ver as convers√µes poss√≠veis, veja a tabela TTZZ
WRITE / l_curto TIME ZONE 'BRAZIL'.
WRITE / l_longo TIME ZONE 'BRAZIL'.
E √© isso. Se voc√™ quiser trabalhar de verdade com timestamps, voc√™ pode utilizar a classe
CL_ABAP_TSTMP,
que tem milh√µes de op√ß√µes. E bem que o comando poderia ter algumas op√ß√µes a mais, tipo uma convers√£o direta de acordo com o Timezone‚Ä¶ üòõ
Abra√ßos!



Coment√°rios:
Flavia Lima (07/03/2023 06:19): Parabens para o Blog que afinal √© sensacional. Mauricio, uma duvida no entanto. Em uma situa√ß√£o onde o servi√ßo de mensageria √© de um parceiro, por exemplo Mastersaf, o CRE_TIMESTAMP criado via SAP ou recebemos essa informa√ß√£o no retorno do envio a Sefaz? Obrigada Fl√°via