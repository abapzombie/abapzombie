BADI‚Äôs, User-exits, Enhancements‚Ä¶ como encontr√°-los?
Autor: Daiane Medeiros
Data: 19/07/2012 14:00

Faaaala Zumbizada! Estou de volta no modo ‚Äúzombie = ON‚Äù por causa do projeto, testes integrados que est√£o acabando com a minha vida (e que nunca acabam!) üôÅ
Bom, mas chega de mimimi e vamos l√°!!! Neste post vou falar sobre alguns m√©todos para encontrar Enhancements, User-exits, BADI‚Äôs e etc. Aposto que isso pode ajudar muito, principalmente para os zumbis mais novinhos. üôÇ
N√£o, isso n√£o √© uma user-exit‚Ä¶
CALL CUSTOMER FUNCTION
Voc√™ pode colocar um BREAK-POINT nesse comando, que √© usado para chamar as User-exits . J√° falamos dele aqui no blog e se quiser saber mais,
clique aqui
.
BADI‚ÄôS
M√©todo 1:
V_EXT_ACT e V_EXT_IMP
A BADI faz uma sele√ß√£o nas tabelas de vis√µes V_EXT_ACT e V_EXT_IMP. Ent√£o podemos ir na transa√ß√£o ST05 -> Selecionar ‚ÄúSQL Trace‚Äù e ‚ÄúTable Buffer Trace‚Äù -> Activate Trace -> Executar a transa√ß√£o -> Deactivate Trace -> Display Trace.
Ir√° aparecer a tela abaixo:
Vamos selecionar os seguintes objetos:
No resultado final ir√° mostrar todas as BADI‚Äôs na ordem em que elas foram executadas:
M√©todo 2:
CL_EXITHANDLER=>GET_CLASS_NAME_BY_INTERFACE
Na transa√ß√£o SE24, vamos selecionar a classe CL_EXITHANDLER, ir para o m√©todo GET_INSTANCE e colocar um BREAK-POINT.
Atrav√©s do par√¢metro de exporta√ß√£o EXIT_NAME √© poss√≠vel saber o nome da BADI que ser√° chamada.
M√©todo 3:
FM SXV_GET_CLIF_BY_NAME.
Um outro m√©todo √© colocando um BREAK-POINT na fun√ß√£o SXV_GET_CLIF_BY_NAME, que √© chamada toda vez que alguma BADI √© executada.
O par√¢metro de exporta√ß√£o NAME ir√° mostrar o nome da BADI.
E a√≠, achou dif√≠cil, chato, deprimente? N√£o se assuste, vou mostrar algumas ferramentas que podem facilitar a sua vida! üôÇ
H√° algum tempo atr√°s precisei encontrar uma user-exit de uma transa√ß√£o X, e no meio de um f√≥rum no SCN encontrei um programa bastante √∫til! Ele lista todas as user-exits e BADI‚Äôs de uma transa√ß√£o ou programa.
Abaixo est√° o c√≥digo-fonte. N√£o sei quem √© o autor e n√£o ser√° coincid√™ncia encontrar esse mesmo programa em outros f√≥runs (√© bem manjado).
REPORT z_enhancement_finder NO STANDARD PAGE HEADING LINE-SIZE 201.

TABLES :  tstc,
          tadir,
          modsapt,
          modact,
          trdir,
          tfdir,
          enlfdir,
          sxs_attrt ,
          tstct.

DATA : jtab LIKE tadir OCCURS 0 WITH HEADER LINE.
DATA : field1(30).
DATA : v_devclass LIKE tadir-devclass.

PARAMETERS : p_tcode LIKE tstc-tcode,
p_pgmna LIKE tstc-pgmna .

DATA wa_tadir TYPE tadir.

START-OF-SELECTION.

  IF NOT p_tcode IS INITIAL.
    SELECT SINGLE * FROM tstc WHERE tcode EQ p_tcode.

  ELSEIF NOT p_pgmna IS INITIAL.
    tstc-pgmna = p_pgmna.
  ENDIF.

  IF sy-subrc EQ 0.
    SELECT SINGLE * FROM tadir
    WHERE pgmid = 'R3TR'
    AND object = 'PROG'
    AND obj_name = tstc-pgmna.

    MOVE : tadir-devclass TO v_devclass.

    IF sy-subrc NE 0.
      SELECT SINGLE * FROM trdir
      WHERE name = tstc-pgmna.
      IF trdir-subc EQ 'F'.
        SELECT SINGLE * FROM tfdir
        WHERE pname = tstc-pgmna.

        SELECT SINGLE * FROM enlfdir
        WHERE funcname = tfdir-funcname.

        SELECT SINGLE * FROM tadir
        WHERE pgmid = 'R3TR'
        AND object = 'FUGR'
        AND obj_name EQ enlfdir-area.

        MOVE : tadir-devclass TO v_devclass.
      ENDIF.
    ENDIF.

    SELECT * FROM tadir INTO TABLE jtab
    WHERE pgmid = 'R3TR'
    AND object IN ('SMOD', 'SXSD')
    AND devclass = v_devclass.

    SELECT SINGLE * FROM tstct
    WHERE sprsl EQ sy-langu
    AND tcode EQ p_tcode.

    FORMAT COLOR COL_POSITIVE INTENSIFIED OFF.
    WRITE:/(19) 'Transaction Code - ',
    20(20) p_tcode,
    45(50) tstct-ttext.
    SKIP.
    IF NOT jtab[] IS INITIAL.
      WRITE:/(105) sy-uline.
      FORMAT COLOR COL_HEADING INTENSIFIED ON.

*      sorting the internal table
      SORT jtab BY object.
      DATA : wf_txt(60) TYPE c,
      wf_smod TYPE i ,
      wf_badi TYPE i ,
      wf_object2(30) TYPE c.
      CLEAR : wf_smod, wf_badi , wf_object2.

*GET the total smod.
      LOOP AT jtab INTO wa_tadir.
        AT FIRST.
          FORMAT COLOR COL_HEADING INTENSIFIED ON.

          WRITE:/1 sy-vline,
          2 'Enhancement/ Business Add-in',
          41 sy-vline ,
          42 'Description',
          105 sy-vline.
          WRITE:/(105) sy-uline.
        ENDAT.
        CLEAR wf_txt.
        AT NEW object.
          IF wa_tadir-object = 'SMOD'.
            wf_object2 = 'Enhancement' .
          ELSEIF wa_tadir-object = 'SXSD'.
            wf_object2 = ' Business Add-in'.

          ENDIF.
          FORMAT COLOR COL_GROUP INTENSIFIED ON.

          WRITE:/1 sy-vline,

          2 wf_object2,
          105 sy-vline.
        ENDAT.

        CASE wa_tadir-object.
          WHEN 'SMOD'.
            wf_smod = wf_smod + 1.
            SELECT SINGLE modtext INTO wf_txt
            FROM modsapt
            WHERE sprsl = sy-langu
            AND name = wa_tadir-obj_name.
            FORMAT COLOR COL_NORMAL INTENSIFIED OFF.

          WHEN 'SXSD'.
*        for badis
            wf_badi = wf_badi + 1 .
            SELECT SINGLE text INTO wf_txt
            FROM sxs_attrt
            WHERE sprsl = sy-langu
            AND exit_name = wa_tadir-obj_name.
            FORMAT COLOR COL_NORMAL INTENSIFIED ON.
        ENDCASE.

        WRITE:/1 sy-vline,
        2 wa_tadir-obj_name HOTSPOT ON,
        41 sy-vline ,
        42 wf_txt,
        105 sy-vline.
        AT END OF object.
          WRITE : /(105) sy-uline.
        ENDAT.
      ENDLOOP.

      WRITE:/(105) sy-uline.

      SKIP.
      FORMAT COLOR COL_TOTAL INTENSIFIED ON.
      WRITE:/ 'No.of Exits:' , wf_smod.
      WRITE:/ 'No.of BADis:' , wf_badi.

    ELSE.
      FORMAT COLOR COL_NEGATIVE INTENSIFIED ON.
      WRITE:/(105) 'No userexits or BADis exist'.
    ENDIF.
  ELSE.
    FORMAT COLOR COL_NEGATIVE INTENSIFIED ON.
    WRITE:/(105) 'Transaction does not exist'.
  ENDIF.

AT LINE-SELECTION.

  DATA : wf_object TYPE tadir-object.
  CLEAR wf_object.

  GET CURSOR FIELD field1.
  CHECK field1(8) EQ 'WA_TADIR'.
  READ TABLE jtab WITH KEY obj_name = sy-lisel+1(20).
  MOVE jtab-object TO wf_object.

  CASE wf_object.
    WHEN 'SMOD'.
      SET PARAMETER ID 'MON' FIELD sy-lisel+1(10).

      CALL TRANSACTION 'SMOD' AND SKIP FIRST SCREEN.
    WHEN 'SXSD'.
      SET PARAMETER ID 'EXN' FIELD sy-lisel+1(20).
      CALL TRANSACTION 'SE18' AND SKIP FIRST SCREEN.
  ENDCASE.
Encontrei tamb√©m esse outro relat√≥rio abaixo. O c√≥digo-fonte est√°
aqui
. Basicamente, tem a mesma funcionalidade, mas eu particularmente prefiro o anterior.
Outras ferramentas
SNIF
E voc√™ pode estar se perguntando: ‚Äún√£o existe nenhum relat√≥rio standard?‚Äù. Sim, existe! A SAP disponibiliza o SNIF (esse √© o nome do programa, n√£o da transa√ß√£o) que lista todos os Costumer Enhancements ativos:
ABAP X-RAY EYE
Pesquisando um pouco mais encontrei um ‚ÄúSNIF melhorado‚Äù, que inclui algumas op√ß√µes, como por exemplo, exits para Valida√ß√£o e Substitui√ß√£o, f√≥rmulas (VOFM), Screen-exits e Field-exits. Esse projeto est√° dispon√≠vel neste link:
http://code.google.com/p/abapexitrayeye/
e para implement√°-lo voc√™ precisar√° usar o
SAP Link
.
Links √öteis:
WIKI: Enhancements and Modifications ‚Äì BADI, Enhancement Framework, User Exits, BTE
WIKI: Ways to find a userexit



Coment√°rios:
Rafael Martin (24/06/2022 10:32): Excelente POST, muito obrigado
Fernando Castro (01/06/2021 12:23): √ìtimo post, parab√©ns!
Fernando Castro (11/11/2020 16:36): √ìtimo post, parab√©ns.
Diego Henrique da Silva (24/07/2020 16:07): Criei um ponto de amplia√ß√£o  ZTM_REFERENCIA_TRANSP na BADI ( BADI_SD_BILLING ), agora preciso criar uma implementa√ß√£o, quando clico para criar ele pede pra digitar uma defini√ß√£o BADI e n√£o sei oq digitar neste campo, podem me ajudar ?
Renan (11/07/2016 08:22): Vlw Daiane, vou trabalhar com BADI‚Äôs pela primeira vez hoje, e n√£o tenho nenhuma ideia de qual BADI devo usar para transfer√™ncia de material, como descubro uma BADI que servir√° para mim, sem saber onde ela j√° foi usada ? oh god!
Estevam Vieira (13/12/2013 08:34): Bom dia, Daiane! Parab√©ns pela in√≠ciativa, seu site √© demais, e uma √≥tima ferramenta. Gostaria de saber se voc√™ poderia me indicar dois ABAPs, eu preciso de Trainee/Jr para regi√£o do Morumbi e Pleno para regi√£o da Av. Paulista. Meu email √© rh@vitroit.com.br Muito Obrigado!
Robson (25/11/2012 14:25): Muito bacana o post! S√≥ um detalhe: o link ‚Äúclique aqui‚Äù do item ‚ÄúCALL CUSTOMER FUNCTION‚Äù est√° quebrado. Abs!
  Mauricio Cruz (28/11/2012 10:48): Opa, corrigido. Valeu Robson!
  Mauricio Cruz (28/11/2012 10:48): Opa, corrigido. Valeu Robson!
Andr√©a (11/11/2012 09:12): Aii que orgulho, DAIII! Nunca tinha lido um post da sua autoria, mujer! Congrats! Adorei üôÇ E me ajudou muito a relembrar‚Ä¶ Ai ai, d√° uma saudade e um aperto no meu cora√ß√£o ver c√≥digo ABAP.. Mais do que eu sinto saudade da minha familia. E eu gostaria de estar brincando hahahaha üòõ
Vinicius (20/09/2012 11:35): Meu m√©todo favorito √© buscando no SDN! :p Outra forma tambem √© usando a boa e velha SE84 -> Enhancements -> Business Add-ins -> Definitions -> e ai busco pelo pacote da transa√ß√£o (ME, por exemplo). O mesmo serve pra customer-exits üôÇ
Danilo Cardoso (05/09/2012 19:10): Fala galera! Esse post  ficou muito loko Daiane! Eu tbm n√£o manjava esses relat√≥rios n√£o. Curto muito aprender essas paradas, obrigado pelas dicas. Estava em conversa com a nossa amiga do cora√ß√£o, Priscila Silva. Fal√°vamos justamente sobre como encontrar BAdIs no sistema e eu escrevi um e-mail para ela detalhando dois m√©todos. Mas n√£o postarei o e-mail aqui, pois, al√©m de ser uma informa√ß√£o redundante, eu escrevi em ingl√™s (s√≥ de brincaiderinha..rs) e utilizei muitas g√≠rias do Bronx ‚Ä¶ algumas pessoas podem achar meio nocivo (mas a Pri riu pra caramba .. rs). Abra√ßos.
  Mauricio Cruz (05/09/2012 22:53): SERIOUSLY, ARE YOU KIDDING ME ?!? PUT THAT MOTHERFUCKING BREAK POINT IN THE MOTHERFUCKING CALL-CUSTOMER FUNCTION INSTRUCTION OR I‚ÄôLL SHOOT YOU IN YOUR GODDAMN FACE! (foi also assim? heoauheoahe)
  Mauricio Cruz (05/09/2012 22:53): SERIOUSLY, ARE YOU KIDDING ME ?!? PUT THAT MOTHERFUCKING BREAK POINT IN THE MOTHERFUCKING CALL-CUSTOMER FUNCTION INSTRUCTION OR I‚ÄôLL SHOOT YOU IN YOUR GODDAMN FACE! (foi also assim? heoauheoahe)
Mauricio Cruz (23/07/2012 10:16): Animal o post Daiane, eu n√£o manjava desses relat√≥rios n√£o‚Ä¶ eu sou meio old-school, sempre tento acha exits c/ os break-points em fun√ß√µes e etcs! haha. Mas talvez eu tenha que mudar um pouco, esses relat√≥rios que voc√™ postou me parecem muito √∫teis! Viva o Open Source, e valeu pelo post!
Renato Bonini (20/07/2012 16:23): S√≥ um pitaco para achar BADIs, standards‚Ä¶ Por ‚Äúpadr√£o‚Äù as Classes Standard da SAP para BADIs tem a nomenclatura ‚ÄúCL_EX_xxxxxxxx‚Äù. Desta forma, acessando a transa√ß√£o SE24 e buscar por ‚ÄúCL_EX_*‚Äù, no campo nome da classe. Vai listar quase todas as BADIs‚Ä¶ e caso voc√™ n√£o consiga chegar na BADI em si pela SE24. Use o complemento do nome da classe na SE18 ou SE19, exemplo: classe: CL_EX_AC_DOCUMENT    => BADI: AC_DOCUMENT []s