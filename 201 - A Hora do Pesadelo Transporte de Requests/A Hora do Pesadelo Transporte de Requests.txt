A Hora do Pesadelo: Transporte de Requests
Autor: Daiane Medeiros
Data: 15/01/2015 12:00

Fala mo√ßada! Meu primeiro post do ano, e √© claro que eu quero come√ßar desejando um excelente 2015, com muita paz, sa√∫de, sucesso e muito debug pra voc√™s! ‚ô•
Bom, agora vamos aos trabalhos‚Ä¶
Imagine a seguinte situa√ß√£o: faltam dois dias para o Go-live e voc√™ precisa verificar a lista de transporte de requests. Ent√£o voc√™ descobre que existem centenas de requests, com milhares de objetos. Logo no come√ßo da lista voc√™ percebe que est√° uma bagun√ßa. Depend√™ncias entre requests que n√£o est√£o na lista, alguns transportes ‚Äún√£o s√£o mais necess√°rios‚Äù, mas as mudan√ßas n√£o foram revertidas no ambiente, alguns transportes emergenciais j√° foram feitos para produ√ß√£o, e assim vai‚Ä¶ E mesmo depois de tudo isso, quando os transportes foram finalmente liberados, surge aquele erro que causa tristeza e depress√£o:
ENCERRADO COM C√ìDIGO DE RETORNO:¬†¬†¬†¬†¬†¬†¬†¬†¬†¬† ===> 8 <===.
Pois √©, meu caro amigo zumbi, isso tamb√©m j√° tirou o sono de muita gente.¬† √â
imposs√≠vel
muito dif√≠cil garantir que todas as requests ser√£o transportadas para a produ√ß√£o sem problemas, e quanto maior a lista, maiores s√£o as chances de erros. Limpar toda a bagun√ßa demora muito tempo
e √© muito chato
. O que fazer ent√£o? A dica mais valiosa que eu dou √©:
‚ÄúSEJA ORGANIZADO‚Äù
Isso mesmo! A maioria dos problemas podem ser evitados se voc√™ ficar bem atento ao criar a lista de transportes e organiz√°-los corretamente antes de liber√°-los. Mas ningu√©m √© perfeito, n√£o √© mesmo?
Se voc√™ n√£o √© t√£o organizado assim e se atrapalha com as depend√™ncias, a dica que eu vou dar agora pode te ajudar.
Acesse a transa√ß√£o SE03 (Transport Organizer) e selecione a op√ß√£o ‚ÄúExibir/modificar atributos da ordem‚Äù na pasta ‚ÄúAdministra√ß√£o‚Äù:
Crie um novo atributo que voc√™ vai usar para gravar o n√∫mero da request que deve ser transportada antes:
Agora, se voc√™ criar/ alterar uma request (transa√ß√£o SE01), na aba ‚ÄúCaracts.‚Äù, o atributo que voc√™ acabou de criar pode ser preenchido no campo ‚ÄúAtributo‚Äù e o n√∫mero da request no campo ‚ÄúValor‚Äù:
Pronto! Agora quando voc√™ (ou qualquer outra pessoa) for liberar a request para transporte, pode verificar quais s√£o as requests que devem ser liberadas primeiro atrav√©s do atributo que voc√™ criou. Mas‚Ä¶ e se algu√©m esquecer de verificar antes de liberar? Voc√™ pode automatizar esse processo implementando o m√©todo ‚ÄúCHECK_BEFORE_RELEASE‚Äù da BADI ‚ÄúCTS_REQUEST_CHECK‚Äù. Basicamente, fazemos uma valida√ß√£o se as requests relacionadas ao atributo j√° foram liberadas.
Mas os problemas n√£o s√£o apenas em rela√ß√£o √† ordem de transporte. Podem existir outros problemas, como por exemplo, outros projetos que utilizam o mesmo objeto ou vers√µes diferentes entre os ambientes de produ√ß√£o e desenvolvimento. Voc√™ precisa estar sempre atento para essas situa√ß√µes.
Como regra geral, User- Exits devem sempre ser transportados separadamente. A mesma regra se aplica para elementos DDIC que podem ou ser√£o usados ‚Äã‚Äãem v√°rios objetos.
Outras considera√ß√µes que devemos fazer: o grupo de fun√ß√£o precisa ser transportado ou apenas a fun√ß√£o? A classe completa dever√° ser transportada ou apenas a implementa√ß√£o do m√©todo? O programa completo (incluindo textos e documenta√ß√£o) dever√° ser transportado ou apenas o c√≥digo do relat√≥rio? Manter a lista de transporte limpa e simples pode evitar uma dor de cabe√ßa mais tarde. üòâ
Vou listar aqui alguns erros comuns que podem acontecer nos transportes:
Perda de funcionalidade na produ√ß√£o (se um transporte mais recente √© sobrescrito);
Transportar c√≥digo para produ√ß√£o que ainda n√£o foi testado;
Objetos dependentes de elementos DDIC (Data Dictionary) que est√£o em desenvolvimento, mas n√£o em produ√ß√£o (gerando DUMPs).
Agora, imagina um projeto que durou mais de um ano, onde v√°rios desenvolvedores trabalharam nele e cada um fez uma lista de transportes. E adivinha quem vai verificar a lista inteira? VOC√ä, claro! Mas calma! Antes que voc√™ vire um zumbi comedor de c√©rebro, vou te mostrar algumas ferramentas que podem te ajudar um pouco nessa dif√≠cil miss√£o.
Para fazer o acompanhamento das requests, eu acho bem legal esse programa:
Transport Trace
. √â um relat√≥rio ALV que mostra os status das requests e o progresso dos transportes. Se voc√™ tem uma lista enorme de requests para monitorar, eu recomendo!
Na minha busca pelo SCN encontrei
esse programa
que verifica se algum objeto est√° faltando no transporte. Fiz um teste bem simples, onde criei uma tabela em uma request e o elemento de dados local. Executei o programa analisando a request e ele detectou o erro sem problemas.
Uma outra ferramenta que eu testei foi a ZTCT ‚Äì Transport Checking Tool (dispon√≠vel
AQUI
), que faz uma an√°lise mais elaborada, como por exemplo, as vers√µes dos objetos.
Aten√ß√£o
: esses programas n√£o detectam erros complexos, mas podem te ajudar a analisar a lista de transporte.
E o Transporte de C√≥pias?
Isso veio para ajudar (e muito) o nosso lado. Se voc√™ ainda n√£o sabe o que √©, se liga.
Vamos imaginar um sistema padr√£o com 3 ambientes: Desenvolvimento (DEV) ‚Äì Qualidade (QAS) ‚Äì e Produ√ß√£o (PRD). Normalmente, todo seu trabalho √© feito no ambiente de DEV e quando voc√™ libera a request para transporte, o sistema assume que ser√° transportado para QAS e depois para PRD. Mas no mundo real sabemos que n√£o √© bem assim, pois nem todos os transportes ir√£o para PRD devido √† corre√ß√£o de bugs, mudan√ßas de escopo, etc.
Por esta raz√£o foi criado o Transporte de C√≥pias. Um transporte de c√≥pias vai passar a vers√£o mais recente do objeto de DEV para QAS, mas n√£o vai assumir que ser√° transportado para PRD. Portando ele transporta uma c√≥pia do objeto e assume que seu destino final √© QAS.
Tamb√©m por esse motivo voc√™ precisar√° criar apenas uma √∫nica request e fazer quantos transportes de c√≥pias forem necess√°rios para testes em QAS. Voc√™ s√≥ precisar√° liberar a request quando quiser realmente transportar para PRD. Dessa forma reduzimos a quantidade de transportes desnecess√°rios e a cria√ß√£o de v√°rias requests para o mesmo objeto. Lembre-se de que quanto maior o n√∫mero de transportes, mais depend√™ncias voc√™ dever√° verificar e, portanto, maiores os riscos de importa√ß√£o de transportes para produ√ß√£o.
Resumindo‚Ä¶
No final das contas, o verdadeiro truque √© ter cuidado desde o in√≠cio. Verifique antes de liberar as requests no ambiente de desenvolvimento. Organize-as corretamente e tente pensar no futuro. Isso pode evitar um monte de problemas. E para fazer isso, uma ferramenta de verifica√ß√£o de transporte pode vir a calhar. Sempre tenha em mente que a responsabilidade pelos transportes s√£o dos desenvolvedores que criaram os objetos e que tem uma ideia melhor do que foi alterado e porqu√™.
E se voc√™ conhece outra ferramenta ou tem algumas dicas para organizar a lista de transporte, compartilha a√≠ com a gente! Valeuuuuuuuuuu galera! ¬†üôÇ



Coment√°rios:
Cloir (18/08/2022 17:03): Ol√° Daiane, como vai? Sou novato no ambiente SAP, fiquei curioso quanto ao programa que vc mencionou, que mostra um ALV das requests, como fa√ßo para acess√°-lo? Parab√©ns pelo post Abra√ßos
Rafael Paes (01/04/2022 09:47): sempre consulto aqui quando chega essa bendita hora no projeto. Grande abra√ßo.
Ricardo (18/12/2017 14:13): Parab√©ns pelo post. Mesmo decorrido um bom tempo ap√≥s sua postagem, para mim hoje esta sendo muito √∫til para elabora√ß√£o de um documento funcional.
Enoque Van-Dunem (14/09/2017 13:46): Bom dia amigos, estou com um problema, a minha consultoria esta trabalhando em um novo desenvolvimento e ao tentar libertar a ordem (request), muitas delas desapareceram da fila de DEV, TST e QAS, ficando apenas intacta a de PRD. Nessa fase, pretendo recuperar as ordem ocultas ou eliminadas porque preciso reimportar algumas. Algu√©m pode ajudar ? Obrigado.
Edher (19/04/2017 10:24): Bom dia. Lembro que a muito tempo atr√°s, trabalhei em um cliente que, ao tentar editar um programa, era verificado se tinha alguma vers√£o que ainda n√£o estivesse em Produ√ß√£o, evitando assim que fosse para PRD alguma vers√£o indevida. Sabe me dizer como posso fazer isso? Algum exemplo?
Rodrigo (22/03/2017 14:53): Estou com um problema causado por requests que subiram indevidamente em produ√ß√£o. Nosso processo normal de carga de request √© aprovar na STMS_QA e ap√≥s  transporte √© feito via JOB para PROD. Quando aprova em STMS_QA, ela solicita a justificativa(texto) e faz login no ambiente de QA. Onde eu vejo este registro de quem aprovou e qual a justificativa? Obrigado e parabenizo pelo excelente conte√∫do deste f√≥rum.
  Daiane Zigiotto (22/03/2017 15:22): Ol√° Rodrigo, conversei com o meu amiguinho Basis e ele me disse que voc√™ poder√° consultar o log nessas duas tabelas: TMSQNOTESH e TMSQWLFH. Abs e obrigada por acompanhar o blog üòÄ
    Rodrigo (22/03/2017 17:01): Daiane, perfeita sua resposta. Realmente as informa√ß√µes est√£o ali. As requests que realmente aprovamos est√£o todas registradas em ambas as tabelas. Minha d√∫vida agora √© que temos requests que subiram em PRD e n√£o aparecem nas tabelas de log de aprova√ß√£o.
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
    Rodrigo (22/03/2017 17:01): Daiane, perfeita sua resposta. Realmente as informa√ß√µes est√£o ali. As requests que realmente aprovamos est√£o todas registradas em ambas as tabelas. Minha d√∫vida agora √© que temos requests que subiram em PRD e n√£o aparecem nas tabelas de log de aprova√ß√£o.
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
  Daiane Zigiotto (22/03/2017 15:22): Ol√° Rodrigo, conversei com o meu amiguinho Basis e ele me disse que voc√™ poder√° consultar o log nessas duas tabelas: TMSQNOTESH e TMSQWLFH. Abs e obrigada por acompanhar o blog üòÄ
    Rodrigo (22/03/2017 17:01): Daiane, perfeita sua resposta. Realmente as informa√ß√µes est√£o ali. As requests que realmente aprovamos est√£o todas registradas em ambas as tabelas. Minha d√∫vida agora √© que temos requests que subiram em PRD e n√£o aparecem nas tabelas de log de aprova√ß√£o.
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
    Rodrigo (22/03/2017 17:01): Daiane, perfeita sua resposta. Realmente as informa√ß√µes est√£o ali. As requests que realmente aprovamos est√£o todas registradas em ambas as tabelas. Minha d√∫vida agora √© que temos requests que subiram em PRD e n√£o aparecem nas tabelas de log de aprova√ß√£o.
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
      Daiane Zigiotto (22/03/2017 17:24): Provavelmente essas requests foram transportadas sem passar pelo fluxo, diretamente pela transa√ß√£o STMS. Para ver o log, acesse a transa√ß√£o STMS_IMPORT e depois o bot√£o ‚ÄúImport History‚Äù. V√° em Edit -> Display More. Nesse log ir√° aparecer todas as requests que foram importadas para o ambiente. Uma breve aulinha de SAP Security üòâ
Luis Godoy (12/01/2016 13:09): √ìtimo post!!! Tenho 6 meses de ABAP e j√° percebi o quanto isso pode se tornar um pesadelo! Obrigado!!!
Utino (14/07/2015 13:40): Na empresa que presto consultoria eles possuem 2DEV ‚Äì 2QAS e 1 PRD. Onde Projetos e Suporte desenvolvem em ambientes diferentes. Transporte √© uma dor de cabe√ßa de outro n√≠vel, pois al√©m de tudo, tamb√©m temos problemas de equaliza√ß√£o e etc :(. Mas valeu pelas dicas !
Edson Penido (27/04/2015 09:41): Estou gostando bastante dos assuntos, principalmente pq sou novo no ABAP. Voc√™ poderia depois postar um subtopico explicando como geramos uma request externa (.zip) para importamos em outro ambiente. Estou pelejando para encontrar algo sobre isto.
  Daiane Zigiotto (27/04/2015 10:18): Oi Edson, obrigada pelo seu coment√°rio! Sobre requests externas eu nunca precisei usar essa solu√ß√£o, mas d√° uma olhada nesse v√≠deo, talvez te ajude! https://youtu.be/_FJTjBLkOA4 Abs
  Daiane Zigiotto (27/04/2015 10:18): Oi Edson, obrigada pelo seu coment√°rio! Sobre requests externas eu nunca precisei usar essa solu√ß√£o, mas d√° uma olhada nesse v√≠deo, talvez te ajude! https://youtu.be/_FJTjBLkOA4 Abs
Anderson Miazato (20/02/2015 12:10): Parab√©ns pelo post, Daiane! Achei as dicas muito √∫teis e interessantes, pode ser que o transporte de requests deixe de ser um pesadelo t√£o grande
  Daiane Zigiotto (26/02/2015 09:41): Valeu, jovem! üôÇ Abs
  Daiane Zigiotto (26/02/2015 09:41): Valeu, jovem! üôÇ Abs
Vagn√£o (19/02/2015 12:59): Dor de cabe√ßa mesmo! Para mim o pior cen√°rio √© garantir que tudo que foi testado em QA est√° tamb√©m em Produ√ß√£o, principalmente quando voc√™ tem v√°rios projetos (e v√°rias consultorias) trabalhando em paralelo. Ou seja, testa legal em QA e na produ√ß√£o d√° dump porque uma tabela foi extendida, mas o projeto n√£o mandou ainda pra frente. Para minimizar (eliminar, nunca) o risco, criei um programa que avalia um conjunto de requests partindo de seus programas. Ou seja, abro o c√≥digo de cada objeto e vejo o que tem de Z dentro (por exemplo: depois de um FROM a tabela come√ßa com Z; depois de um TYPE a estrutura √© Z, e assim por diante. Pego esse Z, identifico o que √© e abro o sistema destino e vejo se a vers√£o √© a mesma. Se n√£o for, report como poss√≠vel erro. Deu trabalho, mas hoje subimos projetos com um pouco mais de tranquilidade.
Soliman (15/01/2015 18:41): Pessoal, O Charm ajuda bastante nesta questao, tem recurso de transporte de copias, consolida tasks e requests em um unico documento (change document). Antes de iniciar um projeto sugira utilizar ele. Outro recurso que eu particularmente acho muito bom eh realizar o merge de todas as requests em uma unica. Assim nao tem sequenciamento, nao tem versao desatualizada e o transporte ao produtivo ocorre em menor tempo e com menor chance de downtime e dumps durante o transporte. abs
  Mauricio Cruz (16/01/2015 08:45): Obrigado pelo coment√°rio! Charm √© bacana mesmo e resolve a maior parte dos problemas gerados pelos controles de transporte, por√©m n√£o s√£o todos os clientes que utilizam. O seu uso envolve licen√ßas relacionadas ao Solman e toda uma mudan√ßa de cultura interna, ent√£o √© uma decis√£o bem grande, n√£o √© como se fosse um add-on que voc√™ pode ativar e j√° era. S√≥ para esclarecer para a galera que n√£o conhece! üôÇ Para saber qlqr coisa de Solman, Charm e etcs, fale com a Raquel: https://twitter.com/raquelsolman
  Mauricio Cruz (16/01/2015 08:45): Obrigado pelo coment√°rio! Charm √© bacana mesmo e resolve a maior parte dos problemas gerados pelos controles de transporte, por√©m n√£o s√£o todos os clientes que utilizam. O seu uso envolve licen√ßas relacionadas ao Solman e toda uma mudan√ßa de cultura interna, ent√£o √© uma decis√£o bem grande, n√£o √© como se fosse um add-on que voc√™ pode ativar e j√° era. S√≥ para esclarecer para a galera que n√£o conhece! üôÇ Para saber qlqr coisa de Solman, Charm e etcs, fale com a Raquel: https://twitter.com/raquelsolman